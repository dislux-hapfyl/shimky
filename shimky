. pnk.lang

MP3_DIR=

fa=RecvTxt
fb=SendTxt
fc=StatTxt
fd=ShellTxt
ta=rcvWidget
tb=sndWidget
td=shellOutput
ws=mp3Cmd
wl=musicBox 
M=master

oa="i$fa.$ta"
ob="i$fb.$tb"
od="i$fd.$td"

aa='fg="white"'
bb='bg="#222"'
bd=bg=$bg
ca='font=("VictorMono",20)'
cb='font=("Iosevka",18)'
cc='font=("VictorMono",14)'
ee='cursor="heart"'
ff='cursor="shuttle"'
fcs='cursor="spider"'
gg='highlightbackground="#111"'
hh='highlightbackground="#444"'
ia='highlightcolor="#2BCDBB"'
ic='highlightcolor="blue"'
ib='highlightcolor="red"'
id='highlightcolor="orange"'
ja='insertbackground="red"'
jb='insertbackground="orange"'
jc='insertbackground="green"'
kk='relief="flat"'
uu='undo=True'
ll='padx=12'
mm='pady=12'
ds='state="disabled"'
en='state="normal"'
wa='height=3'
wd='height=16'
iw='insertwidth=5'

opta=$aa,$bb,$ca,$ee,$gg,$ib,$ja,$kk,$ll,$mm,$ds,$uu,$iw
optb=$aa,$bb,$cb,$ff,$hh,$ia,$jb,$kk,$ll,$mm,$uu,$wa,$iw
optc=$aa,$bb,$cc,$fcs,$gg,$ic,$jc,$kk,$uu,$iw
optd=$aa,$bd,$cb,$ee,$gg,$id,$jc,$kk,$ll,$mm,$uu,$iw,$wd

ZDshebang 
ZDfrm tkinter Tk,Frame,Text,Listbox,PanedWindow
ZDfrm re finditer
ZDfrm threading Thread
ZDfrm os listdir,system,rename,path
ZDfrm pytube YouTube
ZDimp subprocess
ZDimp datetime


ZFtoorwin Shimky
XFpnwin pw '"horizontal"'
XFpk pw 1 both

XFbinda Control-w startNew
XFfc z startNew

YDdefe startNew
XIcv this App
XFfc zz pw.add this


ZDcld App

XIcv i$fb $fb
XIcv i$fa $fa
XFpk i$fb 0 none 
XFpk i$fa 1 y

XFfc z tagConf
XFfc z startSyntaxThd

XFbind $oa Escape myExit
XFbind $oa Shift_R doSyntax
XFbind $ob Control-n myinsert
XFbind $ob Shift_R sendCode
XFbind $ob Control-Shift_R mapit
XFbind $ob Alt-Shift_R mapitOut
XFbind $ob Control-g fgoa
XFbind $ob Control-j bgoa 
XFbind $ob Control-G fgob
XFbind $ob Control-J bgob
XFbind $ob Control-m fntoa
XFbind $ob Control-M fntob
XFbind $ob Return cliSyntax


YDsyntax


YDdefe startSyntaxThd
XFfc zz thdStart doSyntax


YDdefe cliSyntax
XFfc zz syntax $ob
XFfc z doSyntax


YDdefp notif n,m
XIv z n n
XIv z m m
XFtins $ob end "f\"\n$datenow {n} {m}\n\""
XFfc z $ob.see '"end"'


YDdefp thdStart x
XIv z x x
XIfv - thd Thread 'target=x,daemon=True'
XFfc - thd.start


YDdefp chgfg w
XIv z w w
XItgetln $ob fgcolor
XFcfg w. 'fg=fgcolor'


YDdefp chgbg w
XIv z w w
XItgetln $ob bgcolor
XFcfg w. 'bg=bgcolor'


YDdefe fgoa
XFfc zz chgfg $oa


YDdefe bgoa
XFfc zz chgbg $oa


YDdefe fgob
XFfc zz chgfg $ob


YDdefe bgob
XFfc zz chgbg $ob


YDdefe fntoa
XItgetln $ob fntsz
XIv - fn 'int(fntsz)'
XFcfg $oa. 'font=("VictorMono",fn)'


YDdefe fntob
XItgetln $ob fntsz
XIv - fn 'int(fntsz)'
XFcfg $ob. 'font=("Iosevka",fn)'


XIgetcmd() {
	XIfv -z filename $ob.get '"insert linestart+2c","insert lineend"'
}


YDdefe savefile
XIgetcmd
XItgeta $oa data 
XFwrtf data filename
XFfc z notif 'filename,"Saved!"'
XFfc z doSyntax


YDdefe openfile
XIgetcmd
XFfc z myinsert
XFfc z i$fa.cleartxt
XFopft $oa filename
XFfc z notif 'filename,"Opened!"'
XFfc z doSyntax
XFfc z myExit
XFfc z $oa.see 1.0


YDdefe myExit
XFcfg $oa. $ib,$ds
XFfc z $ob.focus


YDdefe myinsert
XFcfg $oa. $ia,$en
XFfc z $oa.focus


YDdefe clearOut
XFfc z i$fd.destroy 
XFfc z $ob.focus


YDdefe mapitOut
XItgetln $ob cmd
XIcv i$fd $fd
XIfv -z wwid i$fa.winfo_width
XFpl i$fd 'wwid//10' 200  
XFbind $od Escape clearOut
XFshspp $od 'f". pnk.lang ; {cmd}"'
XFfc z $od.see 1.0


YDdefe mapit
XFfc z myinsert
XItgetln $ob cmd
XFshspp $oa 'f". pnk.lang ; {cmd}"'
XFfc z $oa.see 1.0
XFfc z myExit


WFdel() {
	WFfc z $oa.delete '"insert-1c linestart","insert lineend"'
}

XKread() {
	local p="$1"
	XKelif "tt[0] == \"$p\""
}

XKFread() {
	local pycom="$1"
	local command="$2"
	XKelif "tt[0] == \"$pycom\""
	WFtins $oa end "f\"$command {strn}\n\"" 
	WFfc z $oa.see '"end"'	
}

YDdefe sendCode
XItgetln $ob txt
XIfv - tt txt.split
XIv - strn '" ".join( str(i) for i in tt[1:])'
XFcfg $oa. $en

XKif 'tt[0] == "i"'
WFtins $oa insert 'f"{strn}\n"'

XKread c
WFtins $oa insert 'f"# {strn}\n"'

XKread o
WFfc z openfile

XKread w
WFfc z savefile

XKread d
WFfc z i$fa.cleartxt

XKread r
WFdel
WFtins $oa insert 'f"{strn}"'
WFfc z $oa.mark_set '"insert","end"'

XKread rn
WFdel
WFtins $oa insert 'f"{strn}\n"'

XKread dd
WItgetln $oa self.ll
WFdel
 
XKread p
WFtins $oa insert 'f"{self.ll}\n"'

XKread m
WFfc z musicBox

XKread md
WFfc z rmMusic


XKFread a00 '. pnk.lang'
XKFread a01 ZDshebang
XKFread a02 ZDfrm
XKFread a10 ZDimp
XKFread a11 ZDas
XKFread a12 ZFtoorwin
XKFread b00 ZDdc
XKFread b01 ZDcld
XKFread b02 ZDcld
XKFread b10 XIcv
XKFread b11 ZFmain
XKFread c00 ZDfd
XKFread c01 YDfd
XKFread c02 XDfd
XKFread c10 WDfd
XKFread d00 ZDdefe
XKFread d01 YDret
XKFread d10 YDdefp
XKFread d11 XDret
XKFread d12 YDdefe
XKFread d20 YDdefs
XKFread d21 XDdefe
XKFread d22 WDret
XKFread d30 XDdefs
XKFread d31 WDdefe
XKFread d32 VDret
XKFread d40 WDdefs
XKFread e00 ZFfc
XKFread e01 YFfc
XKFread e02 XFfc
XKFread e10 WFfc
XKFread e11 VFfc
XKFread e12 UFfc
XKFread f00 ZIfv
XKFread f01 YIfv
XKFread f02 XIfv
XKFread f10 WIfv
XKFread f11 VIfv
XKFread f12 UIfv
XKFread g00 ZIv
XKFread g01 YIv
XKFread g02 XIv
XKFread g10 WIv
XKFread g11 VIv
XKFread g12 UIv
XKFread h00 ZIac
XKFread h01 YIac
XKFread h02 XIac
XKFread h10 WIac
XKFread h11 VIac
XKFread h12 UIac
XKFread h20 ZIrd
XKFread h21 YIrd
XKFread h22 XIrd
XKFread h30 WIrd
XKFread h31 VIrd
XKFread h32 UIrd
XKFread i00 YKtry
XKFread i01 YKexcp
XKFread i02 YKfin
XKFread i10 XKtry
XKFread i11 XKexcp
XKFread i12 XKfin
XKFread i20 WKtry
XKFread i21 WKexcp
XKFread i22 WKfin
XKFread i30 VKtry
XKFread i31 VKexcp
XKFread i32 VKfin
XKFread k00 ZKif
XKFread k01 YKif
XKFread k02 XKif
XKFread k10 WKif
XKFread k11 VKif
XKFread k12 UKif
XKFread k20 ZKiff
XKFread k21 YKiff
XKFread k22 XKiff
XKFread k30 WKiff
XKFread k31 VKiff
XKFread k32 UKiff
XKFread k40 ZKelif
XKFread k41 YKelif
XKFread k42 XKelif
XKFread k50 WKelif
XKFread k51 VKelif
XKFread k52 UKelif
XKFread k60 ZKeliff
XKFread k61 YKeliff
XKFread k62 XKeliff
XKFread k70 WKeliff
XKFread k71 VKeliff
XKFread k72 UKeliff
XKFread k80 ZKelse
XKFread k81 YKelse
XKFread k82 XKelse
XKFread k90 WKelse
XKFread k91 VKelse
XKFread k92 UKelse
XKFread l00 YKbr
XKFread l01 XKbr
XKFread l02 WKbr
XKFread l10 VKbr
XKFread l11 UKbr
XKFread l12 YKctn
XKFread l20 XKctn
XKFread l21 WKctn
XKFread l22 VKctn
XKFread l30 UKctn
XKFread l31 YKps
XKFread l32 XKps
XKFread l40 WKps
XKFread l41 VKps
XKFread l42 UKps
XKFread m00 ZLfor
XKFread m01 YLfor
XKFread m02 XLfor
XKFread m10 WLfor
XKFread m11 VLfor
XKFread m12 ULfor
XKFread m20 ZLffor
XKFread m21 YLffor
XKFread m22 XLffor
XKFread m30 WLffor
XKFread m31 VLffor
XKFread m32 ULffor
XKFread m40 ZLwhile
XKFread m41 YLwhile
XKFread m42 XLwhile
XKFread m50 WLwhile
XKFread m51 VLwhile
XKFread m52 ULwhile
XKFread w00 XFbtn
XKFread w01 XFtext
XKFread w02 XFpnwin
XKFread w10 XFnotebk
XKFread w11 XFentry
XKFread w12 XFlabel
XKFread w20 XFlbox
XKFread t00 XIeget
XKFread t01 XItgetln
XKFread t02 XItget
XKFread t10 XItgeta
XKFread t11 WItgetln
XKFread t12 WItget
XKFread t20 WIeget
XKFread p00 XFpk
XKFread p01 XFpl
XKFread p02 XFgd
XKFread p10 XFgdcfc
XKFread p11 XFgdcfr
XKFread p12 XFbind
XKFread p20 XFbinda
XKFread p21 XFshsp
XKFread p22 XFshspp
XKFread p30 XFpyev
XKFread v00 XFopft
XKFread v01 XFwrtf
XKFread v02 XFset
XKFread v10 XFcfg
XKFread v11 XFedel
XKFread v12 XFeins
XKFread v20 XFtdel
XKFread v21 XFtlndel
XKFread v22 XFtins
XKFread u00 WFtagcfg
XKFread u01 WFtins
XKFread u02 WFset
XKFread u10 WFcfg
XKFread u11 WFedel
XKFread u12 WFeins
XKFread u20 WFtdel
XKFread u21 WFtlndel
XKFread u22 VFtins

XFcfg $oa. $ds
XFfc z doSyntax


YDdefe musicBox
XIcv i$fc $fc
XFpk i$fc 0 none


YDdefe rmMusic
XFfc z i$fc.destroy


ZDcld $fc

XFlbox $wl 64 3
XFcfg $wl. 'font=("Iosevka",16)'
XFpk $wl 0 none

XIcv $ws Text $optc
XFpk $ws 0 none


XFbind $wl Control-r reloadMusic
XFbind $wl Double-Button-1 startMusic
XFbind $wl Return startMusic

XFbind $ws Control-n dlMusic
XFbind $ws Escape clearit

XFfc z loadMusic

YDdefe clearit
XFtdel $ws 1.0 end

YDdefe loadMusic
XIfv - filelist listdir "\"$MP3_DIR\""
XIfv - musiclist sorted filelist
XLfor song musiclist
WFtins $wl end 'f"{song}"'


YDdefe reloadMusic
XFedel $wl
XFfc z loadMusic


YDdefp cleanfn fn
XIv - vc '"-"'
XIv - out '""'
XLfor c fn
WKif 'str.isalnum(c) or (c in vc)'
VIac - out c
WKelse
VIac - out '""'
XDret out


YDdefp notif n,m
XIv z n n
XIv z m m
XFtins $ws 1.0 "f\"$datenow {n} {m}\n\""


YDdefe getMp3
XItgetln $ws url
XFfc z notif 'url,"Downloading"'
XIv - filepath "\"$MP3_DIR\""
XIfv - daurl YouTube url
XIfv - damusic daurl.streams.filter 'only_audio=True'
XIfv - music damusic.first
XIfv - raw music.download 'output_path=filepath'
XIfv - head,t path.splitext raw
XIfv - base path.basename head
XIfv -z filename cleanfn base
XIv - outfile 'f"{filepath}{filename}.mp3"'
XFfc - rename raw,outfile
XFfc z reloadMusic
XFfc z notif 'filename,"Ready 2 Play!"'


YDdefe playMp3
XIfv -zz sel $wl.get "$wl.curselection()"
XFfc - system "f\"mpv $MP3_DIR{sel}\""


YDdefe dlMusic
XFfc zz $M.thdStart getMp3


YDdefe startMusic
XFfc zz $M.thdStart playMp3



ZDcld $fa
XIcv $ta Text $opta
XFpk $ta 1 y
XFbind $ta space $M.myinsert
YDdefe cleartxt
XFtdel $ta 1.0 end


ZDcld $fb
XIcv $tb Text $optb
XFpk $tb 0 none
XFfc z $tb.focus
XFbind $tb Escape cleartxt
YDdefe cleartxt
XFtdel $tb 1.0 end


ZDcld $fd
XIcv $td Text $optd 
XFpk $td 0 none
XFfc z $td.focus


ZFmain Shimky shimky
