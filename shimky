. ./pnk.lang


fa=RecvTxt
fb=SendTxt
fc=StatTxt
ta=rcvWidget
tb=sndWidget
M=master

oa="i$fa.$ta"
ob="i$fb.$tb"
oc="i$fc.$ta"

aa='fg="#ECCCA2"'
bb='bg="#222"'
ca='font=("VictorMono",20)'
cb='font=("Iosevka",18)'
cc='font=("VictorMono",14)'
ee='cursor="heart"'
ff='cursor="shuttle"'
fcs='cursor="spider"'
gg='highlightbackground="#111"'
hh='highlightbackground="#444"'
ia='highlightcolor="#2BCDBB"'
ic='highlightcolor="blue"'
ib='highlightcolor="red"'
ja='insertbackground="red"'
jb='insertbackground="orange"'
jc='insertbackground="green"'
kk='relief="flat"'
uu='undo=True'
ll='padx=12'
mm='pady=12'
ds='state="disabled"'
en='state="normal"'
wa='height=3'
iw='insertwidth=5'

opta=$aa,$bb,$ca,$ee,$gg,$ib,$ja,$kk,$ll,$mm,$ds,$uu,$iw
optb=$aa,$bb,$cb,$ff,$hh,$ia,$jb,$kk,$ll,$mm,$uu,$wa,$iw
optc=$aa,$bb,$cc,$fcs,$gg,$ic,$jc,$kk,$uu,$iw

ZDshebang 
ZDfrm tkinter Tk,Frame,Text
ZDfrm re finditer
ZDfrm threading Thread
ZDimp subprocess
ZDimp datetime


ZFtoorwin Shimky

XIcv i$fa $fa
XIcv i$fb $fb
XFpk i$fb 0 none
XFpk i$fa 0 none


XFfc z tagConf


XFbinda Shift_R doSyntax
XFbind $oa Escape myExit
XFbind $ob Control-n myinsert
XFbind $ob Return sendCode
XFbind $ob Control-Shift_R mapit
XFbind $ob Control-g fgoa
XFbind $ob Control-j bgoa 
XFbind $ob Control-G fgob
XFbind $ob Control-J bgob
XFbind $ob Control-m fntoa


YDsyntax


YDdefp chgfg w
XIv z w w
XItgetln $ob fgcolor
XFcfg w. 'fg=fgcolor'


YDdefp chgbg w
XIv z w w
XItgetln $ob bgcolor
XFcfg w. 'bg=bgcolor'


YDdefe fgoa
XFfc zz chgfg $oa


YDdefe bgoa
XFfc zz chgbg $oa


YDdefe fgob
XFfc zz chgfg $ob


YDdefe bgob
XFfc zz chgbg $ob


YDdefp chgfnt w
XIv z w w
XItgetln $ob fntsz
XIv - fn 'int(fntsz)'
XFcfg w. 'font=("VictorMono",fn)'


YDdefe fntoa
XFfc zz chgfnt $oa


XIgetcmd() {
	XIfv -z filename $ob.get '"insert linestart+2c","insert lineend"'
}


YDdefe savefile
XIgetcmd
XItgeta $oa data 
XFwrtf data filename
XFfc z doSyntax


YDdefe openfile
XIgetcmd
XFfc z myinsert
XFfc z i$fa.cleartxt
XFopft $oa filename
XFfc z doSyntax
XFfc z myExit
XFfc z $oa.see 1.0


YDdefe myExit
XFcfg $oa. $ib,$ds
XFfc z $ob.focus


YDdefe myinsert
XFcfg $oa. $ia,$en
XFfc z $oa.focus


YDdefe mapit
XFfc z myinsert
XItgetln $ob cmd
XFshspp $oa 'f". ./pnk.lang ; {cmd}"'
XFfc z $oa.see 1.0
XFfc z myExit


YDdefe sendCode
XItgetln $ob txt
XIfv - tt txt.split
XIv - strn '" ".join( str(i) for i in tt[1:])'
XFcfg $oa. $en

XKif 'tt[0] == "i"'
WFfc z $oa.see '"end"'
WFtins $oa insert 'f"{strn}\n"'

XKelif 'tt[0] == "o"'
WFfc z openfile

XKelif 'tt[0] == "w"'
WFfc z savefile

XKelif 'tt[0] == "d"'
WFfc z i$fa.cleartxt

XKelif 'tt[0] == "r"'
WFfc z $oa.delete '"insert-1c linestart","insert lineend"'
WFtins $oa insert 'f"{strn}"'

XKelif 'tt[0] == "dd"'
WItgetln $oa self.ll
WFfc z $oa.delete '"insert linestart","insert lineend"'

XKelif 'tt[0] == "dl"'
WFfc z $oa.delete '"insert-1c linestart","insert lineend"'

XKelif 'tt[0] == "p"'
WFtins $oa insert 'f"{self.ll}"'

XKelif 'tt[0] == "c"'
WFfc z mkStat

XKelif 'tt[0] == "cd"'
WFfc z rmStat

XKelif 'tt[0] == "ii"'
WFtins $oc insert 'f"{strn} "'

XFcfg $oa. $ds
XFfc z doSyntax


YDdefe mkStat
XIcv i$fc $fc
XFpk i$fc 0 none


YDdefe rmStat
XFfc z i$fc.destroy



ZDcld $fc
XIcv $ta Text $optc
XFpk $ta 1 both



ZDcld $fa
XIcv $ta Text $opta
XFpk $ta 1 both
XFbind $ta Control-l cleartxt
XFbind $ta Shift_R $M.myinsert
YDdefe cleartxt
XFtdel $ta 1.0 end



ZDcld $fb
XIcv $tb Text $optb
XFpk $tb 1 both
XFfc z $tb.focus
XFbind $tb Escape cleartxt
YDdefe cleartxt
XFtdel $tb 1.0 end



ZFmain Shimky shimky


